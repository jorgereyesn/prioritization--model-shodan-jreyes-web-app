import React from "react";
import * as S from "./cve-details.styles";
import TransitionsModal from "../modal-references-cve/references-cve.component";

const CveDetailsComponent = ({ cve, references, cvss, summary }) => {
  let color = "";
  let textColor = "black";

  if (cvss > 0 && cvss < 4) {
    color = "green";
    textColor = "white";
  }

  if (cvss > 3.9 && cvss < 7) {
    color = "yellow";
  }
  if (cvss > 6.9 && cvss < 9) {
    color = "red";
    textColor = "white";
  }
  if (cvss > 8.9 && cvss < 11) {
    color = "#34495E";
    textColor = "white";
  }

  return (
    <S.Wrapper>
      <S.CveGrid container justifyContent="center" alignItems="center">
        <S.Cve item xs={3}>
          <S.Link
            href={`https://nvd.nist.gov/vuln/detail/` + cve}
            target="_blank"
          >
            {cve}
          </S.Link>
        </S.Cve>
        <S.References item xs={3}>
          <TransitionsModal
            buttonName="Solution Links"
            references={references}
          />
        </S.References>
        <S.Cvss item xs={3} color={color} textcolor={textColor}>
          {cvss}
        </S.Cvss>
        <S.Summary item xs={12}>
          {summary}
        </S.Summary>
      </S.CveGrid>
    </S.Wrapper>
  );
};
export default CveDetailsComponent;
